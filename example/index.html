<!DOCTYPE html>
<html>
<head>
	<title>Hub.js | Example</title>
	<script type="text/javascript" src="../hub.js"></script>
	<!-- <script type="text/javascript" src="example.js"></script> -->
	<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

	<style type="text/css">
		html, body {
			margin: 0;
			padding: 0;
		}
		body {
			max-width: 800px;
			margin: 0 auto;
		}
		a {color: #666;text-decoration: none; }
		a:hover {text-decoration: none; color: #333;}
		.split {
			width: 50%;
			float: left;	
		}
	</style>
</head>
<body>
	
	<h1>Hub.js</h1>
	<p>Most of what happens here, is in the code / console.</p>
	<p><em><a href="http://twitter.com/christopherdb">@christopherdb</a></em></p>


	<div>
	<div class="split">
		<div class="split">
			<input type="text" value="red" name="colour1"/>
			<a href="#" class="colour">Set</a>
		</div>
		<div class="split">
			<input type="text" value="blue" name="colour2"/>
			<a href="#"class="colour">Set</a>
		</div>
	</div>
	<div class="split">
		<div class="split">
			<input type="text" value="green" name="colour3"/>
			<a href="#" class="colour">Set</a>
		</div>
		<div class="split">
			<input type="text" value="yellow" name="colour4"/>
			<a href="#" class="colour">Set</a>
		</div>
	</div>
	</div>
	<br><br><br>
	<p><a href="#" class="dump">Dump</a> all items in Hub to console.</p>

	<script type="text/javascript">
		
		var myHub = new Hub()


		// background colour definitions

		myHub.addSetter("backgroundColour", function(){
			$("html, body").css("background-color", this.value)	
		})

		myHub.addGetter("backgroundColour", {
			requires: ["colour1"],
			func: function() {
			
				myHub.get("colour1", function(value){
					myHub.set("backgroundColour", value)
				})
			}
		})



		// text colour definitions

		myHub.addSetter("textColour", function(){
			$("html, body").css("color", this.value)	
		})

		myHub.addGetter("textColour", {
			requires: ["colour2"],
			func: function() {
			
				myHub.get("colour2", function(value){
					myHub.set("textColour", value)
				})
			}
		})


		// link colour definitions

		myHub.addSetter("linkColour", function() {
			$("a").css("color", this.value);
		})

		myHub.addGetter("linkColour", {
			requires: ["colour3"],
			func: function(requires) {
				myHub.set("linkColour", requires.colour3)
			}
		})


		// all colours set

		myHub.addGetter("allColours", {
			requires: ["colour1", "colour2", "colour3", "colour4"],
			func: function(requires) {
				console.log("allColours() called with: ", requires)
				myHub.set("allColours", requires)
			}
		})

		myHub.addSetter("allColours", function(){
			console.log("Setter called for allColours() => this.value = ", this.value);

			$("body").append("<h1><span class='colour1'>all colours</span> <span class='colour2'>have been</span> <span class='colour3'>set or</span> <span class='colour4'>updated...</span></h1>");

			$(".colour1").css("color", this.value.colour1)
			$(".colour2").css("color", this.value.colour2)
			$(".colour3").css("color", this.value.colour3)
			$(".colour4").css("color", this.value.colour4)
		})


		$(document).ready(function(){
			
			$(".colour").click(function(ev) {
				ev.preventDefault()
				var el = $(this).parent().find("input")
				var item = el.attr("name")
				var value = el.attr("value")
				myHub.set(item, value)
			})

			$(".dump").click(function(ev) {
				ev.preventDefault()
				myHub.dumpItems()
			})

		})

	</script>
</body>
</html>